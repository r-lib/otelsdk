<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>R Implementation of OpenTelemetry, Exporters • otelsdk</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="R Implementation of OpenTelemetry, Exporters">
<meta name="description" content="High-quality, ubiquitous, and portable telemetry to enable effective observability. OpenTelemetry is a collection of tools, APIs, and SDKs used to instrument, generate, collect, and export telemetry data (metrics, logs, and traces) for analysis in order to understand your softwares performance and behavior. Use this package to export traces, metrics, logs through the OpenTelemetry Protocol (OTLP').">
<meta property="og:description" content="High-quality, ubiquitous, and portable telemetry to enable effective observability. OpenTelemetry is a collection of tools, APIs, and SDKs used to instrument, generate, collect, and export telemetry data (metrics, logs, and traces) for analysis in order to understand your softwares performance and behavior. Use this package to export traces, metrics, logs through the OpenTelemetry Protocol (OTLP').">
<script defer data-domain="all.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">otelsdk</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/otelsdk/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="otelsdk">otelsdk<a class="anchor" aria-label="anchor" href="#otelsdk"></a>
</h1></div>
<blockquote>
<p>OpenTelemetry SDK for R packages and projects</p>
</blockquote>
<!-- badges: start -->

<p>High-quality, ubiquitous, and portable telemetry to enable effective observability. <a href="https://opentelemetry.io/docs/" class="external-link">OpenTelemetry</a> is a collection of tools, APIs, and SDKs used to instrument, generate, collect, and export telemetry data (metrics, logs, and traces) for analysis in order to understand your software’s performance and behavior.</p>
<p>Use the <a href="https://github.com/r-lib/otel" class="external-link">otel</a> package as a dependency if you want to instrument your R package or project for OpenTelemetry.</p>
<p>Use this package (otelsdk) to produce OpenTelemetry output from an R package or project that was instrumented with the otel package.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<blockquote>
<p>[!WARNING] This package is experimental and may introduce breaking changes any time. It probably works best with the latest commit of the <a href="https://github.com/r-lib/otel" class="external-link">otel</a> package.</p>
</blockquote>
<p>You can install the development version of otel from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"r-lib/otelsdk"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="compiling-from-source">Compiling from source<a class="anchor" aria-label="anchor" href="#compiling-from-source"></a>
</h3>
<p>To compile otelsdk from source, you need to install the protobuf library first:</p>
<ul>
<li><p>On Windows install the correct version of <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a>.</p></li>
<li><p>On Linux install the appropriate package from your distribution.</p></li>
<li>
<p>On macOS, you can use CRAN’s <a href="https://mac.r-project.org/bin/" class="external-link">protobuf build</a> or Homebrew. If you are using CRAN’s build, then you must uninstall or unlink Homebrew protobuf:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>brew unlink protobuf</span></code></pre></div>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<ul>
<li><p>Instrument your R package or project using the <a href="https://github.com/r-lib/otel" class="external-link">otel</a> package.</p></li>
<li><p>Choose an exporter from the otelsdk package. The <code>http</code> exporter sends OpenTelemetry output through OTLP/HTTP.</p></li>
<li><p>Set the <code>OTEL_TRACES_EXPORTER</code> environment variable to point to the exporter of your choice. E.g. for OTLP/HTTP set <code>OTEL_TRACES_EXPORTER=http</code>.</p></li>
<li>
<p>If you are sending telemetry data through HTTP, then you typically need to configure the URL of your OpenTelemetry collector, and you possibly also need to supply a token in an HTTP header, possibly some resource attributes. Follow the instructions of the provider of your collector. They typically don’t have instructions for R, but generic instructions about environment variables will work for the otelsdk R package. E.g. for <a href="https://grafana.com/" class="external-link">Grafana</a> you need something like</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>OTEL_EXPORTER_OTLP_PROTOCOL<span class="ot">=</span><span class="st">"http"</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>OTEL_EXPORTER_OTLP_ENDPOINT<span class="ot">=</span><span class="st">"https://otlp-gateway-prod-eu-central-0.grafana.net/otlp"</span> \</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>OTEL_RESOURCE_ATTRIBUTES<span class="ot">=</span><span class="st">"service.name=&lt;name-of-your-app&gt;,service.namespace=&lt;name-of-your-namespace&gt;,deployment.environment=test"</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>OTEL_EXPORTER_OTLP_HEADERS<span class="ot">=</span><span class="st">"Authorization=Basic%20&lt;base64-encoded-token&gt;"</span></span></code></pre></div>
<p>See more example below.</p>
</li>
<li><p>Start R and your app. Telemetry data will be exported to the chosen exporter.</p></li>
</ul>
<div class="section level3">
<h3 id="setup-for-remote-collectors">Setup for remote collectors<a class="anchor" aria-label="anchor" href="#setup-for-remote-collectors"></a>
</h3>
<p>There are a lot of services that offer an OpenTelemetry collector for tracers, logs and metrics, many of them supporting all three of them. There are also local apps that work as a collector. We tried otelsdk with the following ones:</p>
<div class="section level4">
<h4 id="grafana">
<a href="https://grafana.com/" class="external-link">Grafana</a><a class="anchor" aria-label="anchor" href="#grafana"></a>
</h4>
<p>Follow the <a href="https://grafana.com/docs/grafana-cloud/send-data/otlp/send-data-otlp/#manual-opentelemetry-setup-for-advanced-users" class="external-link">documentation</a>. Create an API token. You’ll need to use the Grafana instrance ID as your username, and the token as the password in HTTP Basic auth. E.g. in R do this to get the base64 encoded token. <code>instance-id</code> is a (currently seven digit) number and a string with a <code>glc_</code> prefix.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">openssl</span><span class="fu">::</span><span class="fu"><a href="https://jeroen.r-universe.dev/openssl/reference/base64_encode.html" class="external-link">base64_encode</a></span><span class="op">(</span><span class="st">"&lt;instance-id&gt;:&lt;api-token&gt;"</span><span class="op">)</span></span></code></pre></div>
<p>Then use this encoded token to set the <code>Authorization</code> header:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>OTEL_EXPORTER_OTLP_PROTOCOL<span class="ot">=</span><span class="st">"http"</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>OTEL_EXPORTER_OTLP_ENDPOINT<span class="ot">=</span><span class="st">"https://otlp-gateway-prod-eu-central-0.grafana.net/otlp"</span> \</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>OTEL_EXPORTER_OTLP_HEADERS<span class="ot">=</span><span class="st">"Authorization=Basic%20&lt;base64-encoded-token&gt;"</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>OTEL_RESOURCE_ATTRIBUTES<span class="ot">=</span><span class="st">"service.name=&lt;name-of-your-app,service.namespace=&lt;name-of-your-namespace&gt;,deployment.environment=test"</span></span></code></pre></div>
<p>Your endpoint URL is probably different, use the one that you see on your dashboard.</p>
<p>If you want to export logs and/or metrics, set these environment variables, respectively:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>OTEL_LOGS_EXPORTER<span class="ot">=</span>http</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>OTEL_LOG_LEVEL<span class="ot">=</span>debug</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>OTEL_METRICS_EXPORTER<span class="ot">=</span>http</span></code></pre></div>
<p>It also makes sense to set the desired log level.</p>
<p>Grafana suggests running an OpenTelemetry collector on premise instead of sending telemetry data to them directly. But nevertheless you can start out without running your own collector, they call this “quick start” mode.</p>
</div>
<div class="section level4">
<h4 id="pydantic-logfire">
<a href="https://pydantic.dev/logfire" class="external-link">Pydantic Logfire</a><a class="anchor" aria-label="anchor" href="#pydantic-logfire"></a>
</h4>
<p>Create a project and a write token. Note that the URLs you need to use are different if you are within the EU! You probably need to replace <code>us</code> with <code>eu</code> in the URL if you are in the EU. Set these environment variables:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>OTEL_TRACES_EXPORTER<span class="ot">=</span>http</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>OTEL_EXPORTER_OTLP_ENDPOINT<span class="ot">=</span><span class="st">"https://logfire-us.pydantic.dev"</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>OTEL_EXPORTER_OTLP_HEADERS<span class="ot">=</span><span class="st">"Authorization=&lt;your-write-token&gt;"</span></span></code></pre></div>
<p>For logs also set <code>OTEL_LOGS_EXPORTER</code> and the desired log level:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>OTEL_LOGS_EXPORTER<span class="ot">=</span>http</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>OTEL_LOG_LEVEL<span class="ot">=</span>debug</span></code></pre></div>
<p>For exporting metrics also set</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>OTEL_METRICS_EXPORTER<span class="ot">=</span>http</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="setup-for-local-collectors">Setup for local collectors<a class="anchor" aria-label="anchor" href="#setup-for-local-collectors"></a>
</h3>
<div class="section level4">
<h4 id="otel-tui">
<a href="https://github.com/ymtdzzz/otel-tui" class="external-link">otel-tui</a><a class="anchor" aria-label="anchor" href="#otel-tui"></a>
</h4>
<p><code>otel-tui</code> is a terminal app that supports traces, logs and metrics. It is great for development, as you can keep all your telemetry local while instrumenting your package or app. Follow the installation instructions and then run the app from a terminal:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>otel<span class="sc">-</span>tui</span></code></pre></div>
<p>It listens on the default port, so the setup is very simple, set these environment variables (or a subset if you don’t want metrics or logs):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>OTEL_TRACES_EXPORTER<span class="ot">=</span>http</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>OTEL_LOGS_EXPORTER<span class="ot">=</span>http</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>OTEL_LOG_LEVEL<span class="ot">=</span>debug</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>OTEL_METRICS_EXPORTER<span class="ot">=</span>http</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="otel-desktop-viewer">
<a href="https://github.com/CtrlSpice/otel-desktop-viewer" class="external-link">otel-desktop-viewer</a><a class="anchor" aria-label="anchor" href="#otel-desktop-viewer"></a>
</h4>
<p><code>otel-desktop-viewer</code> is similar to <code>otel-tui</code>, but has a web UI. Follow the installation instructions and start the app from a terminal:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>otel<span class="sc">-</span>desktop<span class="sc">-</span>viewer</span></code></pre></div>
<p>It should start a new windows or tab in your local web browser. Set the usual environment variable for your R app:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>OTEL_TRACES_EXPORTER<span class="ot">=</span>http</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="jaeger">
<a href="https://www.jaegertracing.io/" class="external-link">Jaeger</a><a class="anchor" aria-label="anchor" href="#jaeger"></a>
</h4>
<p>If you have Docker, you can start a <a href="https://www.jaegertracing.io/" class="external-link">Jaeger</a> container on the default port:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>docker run <span class="sc">--</span>rm <span class="sc">--</span>name jaeger \</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a> <span class="sc">-</span>p <span class="dv">16686</span><span class="sc">:</span><span class="dv">16686</span> \</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a> <span class="sc">-</span>p <span class="dv">4317</span><span class="sc">:</span><span class="dv">4317</span> \</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a> <span class="sc">-</span>p <span class="dv">4318</span><span class="sc">:</span><span class="dv">4318</span> \</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a> <span class="sc">-</span>p <span class="dv">5778</span><span class="sc">:</span><span class="dv">5778</span> \</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a> <span class="sc">-</span>p <span class="dv">9411</span><span class="sc">:</span><span class="dv">9411</span> \</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a> jaegertracing<span class="sc">/</span>jaeger<span class="sc">:</span><span class="dv">2</span>.<span class="fl">4.0</span></span></code></pre></div>
<p>Go to <code>http://localhost:16686/</code> to view the Jaeger UI.</p>
</div>
<div class="section level4">
<h4 id="signoz">
<a href="https://github.com/SigNoz/signoz" class="external-link">SigNoz</a><a class="anchor" aria-label="anchor" href="#signoz"></a>
</h4>
<p>To run SigNoz locally with Docker, clone the repository at <a href="https://github.com/SigNoz/signoz" class="external-link uri">https://github.com/SigNoz/signoz</a>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>git clone <span class="sc">--</span>depth <span class="dv">1</span> https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>SigNoz<span class="sc">/</span>signoz</span></code></pre></div>
<p>and then run Docker Compose from the <code>deploy/docker/</code> subdirectory:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>cd deploy<span class="sc">/</span>docker</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>docker compose up</span></code></pre></div>
<p>Go to <code>http://localhost:8080</code> to see the SigNoz UI.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT © Posit, PBC</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/r-lib/otelsdk/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing otelsdk</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/gaborcsardi" class="external-link">Gábor Csárdi</a> <br><small class="roles"> Author, maintainer </small>   </li>
<li>
<a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a> <br><small class="roles"> Copyright holder, funder </small>  <a href="https://ror.org/03wc8by49" class="external-link"><img src="https://raw.githubusercontent.com/ror-community/ror-logos/main/ror-icon-rgb.svg" class="ror" alt="ROR"></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/r-lib/otelsdk/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/r-lib/otelsdk/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/r-lib/otelsdk" class="external-link"><img src="https://codecov.io/gh/r-lib/otelsdk/graph/badge.svg?token=GAqo3S38e7" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gaborcsardi" class="external-link">Gábor Csárdi</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer>
</body>
</html>
